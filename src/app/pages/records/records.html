<div class="trainer-assignment-container">
  <h2 class="section-title">Records Management</h2>

  <!-- Feedback Message Display -->
  <div *ngIf="feedbackMessage" class="feedback-message">
    {{ feedbackMessage }}
  </div>

  <!-- Filter Bar -->
  <form class="filter-bar" (ngSubmit)="onSearch()" #filterForm="ngForm">
    <div class="filter-fields">
      <label for="date-filter-type" class="visually-hidden">Date Filter Type</label>
      <select id="date-filter-type" class="dropdown" [(ngModel)]="selectedDateFilterType" name="dateFilterType">
        <option *ngFor="let type of dateFilterTypes" [value]="type">{{ type }}</option>
      </select>

      <!-- Conditional Date Inputs -->
      <ng-container [ngSwitch]="selectedDateFilterType">
        <input *ngSwitchCase="'Daily'" type="date" [(ngModel)]="selectedDate" name="selectedDate" class="add-trainer-input">
        <div *ngSwitchCase="'Monthly'" class="date-group">
          <label for="selectedYearMonth" class="visually-hidden">Year</label>
          <input id="selectedYearMonth" type="number" placeholder="Year" [(ngModel)]="selectedYear" name="selectedYearMonth" class="add-trainer-input" min="1900" max="2100">
          <label for="selectedMonth" class="visually-hidden">Month</label>
          <select id="selectedMonth" class="dropdown" [(ngModel)]="selectedMonth" name="selectedMonth">
            <option *ngFor="let m of [1,2,3,4,5,6,7,8,9,10,11,12]" [value]="m">{{ m | date:'MMMM' }}</option>
          </select>
        </div>
        <div *ngSwitchCase="'Quarterly'" class="date-group">
          <label for="selectedYearQuarter" class="visually-hidden">Year</label>
          <input id="selectedYearQuarter" type="number" placeholder="Year" [(ngModel)]="selectedYear" name="selectedYearQuarter" class="add-trainer-input" min="1900" max="2100">
          <label for="selectedQuarter" class="visually-hidden">Quarter</label>
          <select id="selectedQuarter" class="dropdown" [(ngModel)]="selectedQuarter" name="selectedQuarter">
            <option value="1">Q1 (Jan-Mar)</option>
            <option value="2">Q2 (Apr-Jun)</option>
            <option value="3">Q3 (Jul-Sep)</option>
            <option value="4">Q4 (Oct-Dec)</option>
          </select>
        </div>
        <input *ngSwitchCase="'Annually'" type="number" placeholder="Year" [(ngModel)]="selectedYear" name="selectedYearAnnually" class="add-trainer-input" min="1900" max="2100">
      </ng-container>

      <label for="region-select" class="visually-hidden">Region</label>
      <select  id="region-select" class="dropdown" [(ngModel)]="selectedRegion" name="region">
        <option value="">All Regions</option>
        <option *ngFor="let reg of regions" [value]="reg">{{ reg }}</option>
      </select>

      <label for="entity-type-select" class="visually-hidden">Entity Type</label>
      <select id="entity-type-select" class="dropdown" [(ngModel)]="selectedEntityType" name="entityType">
        <option *ngFor="let type of entityTypes" [value]="type">{{ type }}</option>
      </select><!-- Place your multi-selects here -->
    <ng-container *ngIf="selectedEntityType === 'Units'">
      <label for="unit-select" class="visually-hidden">Unit</label>
      <app-multi-select
        [items]="units"
        [displayWith]="unit => unit.Name"
        [(selected)]="selectedUnits"
        (selectionChange)="onUnitsChange($event)">
      </app-multi-select>
    </ng-container>
    <ng-container *ngIf="selectedEntityType === 'Trainers'">
      <label for="trainer-select" class="visually-hidden">Trainer</label>
      <app-multi-select
        [items]="trainers"
        [displayWith]="trainer => trainer"
        [(selected)]="selectedTrainers"
        (selectionChange)="onTrainersChange($event)">
      </app-multi-select>
    </ng-container>

    </div>
    
   <button type="submit" class="search-btn">Search</button>
    <button type="button" class="reset-btn" (click)="onReset()">Reset</button>
  </form>
  

  <div class="table-container">
    <table>
      <thead>
        <tr>
          <th>Sl No</th>
          <th>Date</th>
          <th>Type</th>
          <th>Unit Name</th>
          <th>Region</th>
          <th>Trainer Email</th>
          <th>Description</th>
          <th>Value</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let record of filteredRecords; let i = index">
          <td>{{ i + 1 }}</td>
          <td>{{ record.date | date:'mediumDate' }}</td>
          <td>{{ record.type }}</td>
          <td>{{ record.unitName || '-' }}</td>
          <td>{{ record.region || 'N/A' }}</td>
          <td>{{ record.trainerEmail || '-' }}</td>
          <td>{{ record.description }}</td>
          <td>{{ record.value || '-' }}</td>
        </tr>
        <tr *ngIf="filteredRecords.length === 0">
          <td colspan="8" class="no-data-message">No records found matching the criteria.</td>
        </tr>
      </tbody>
    </table>
    <button class="download-btn" (click)="downloadReport()">Download Report</button>
  </div>
</div>
